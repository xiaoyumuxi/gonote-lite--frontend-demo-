# GoNote API æ¥å£æ–‡æ¡£

åç«¯åŸºäº **Go + Gin + GORM + SQLite** æ„å»ºï¼Œè¿è¡Œåœ¨ `http://localhost:8080`ã€‚

---

## ç›®å½•

- [è®¤è¯æ¥å£ (Auth)](#è®¤è¯æ¥å£-auth)
- [å®¶åº­æ¥å£ (Family)](#å®¶åº­æ¥å£-family)
- [ç¬”è®°æ¥å£ (Notes)](#ç¬”è®°æ¥å£-notes)
- [äº‹ä»¶æ¥å£ (Events)](#äº‹ä»¶æ¥å£-events)

---

## è®¤è¯æ¥å£ (Auth)

### ç”¨æˆ·æ³¨å†Œ

åˆ›å»ºæ–°ç”¨æˆ·è´¦å·ã€‚

```http
POST /api/auth/register
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "string (3-20å­—ç¬¦)",
  "password": "string (è‡³å°‘6å­—ç¬¦)"
}
```

**æˆåŠŸå“åº” (201)ï¼š**
```json
{
  "message": "æ³¨å†ŒæˆåŠŸ",
  "token": "mock-jwt-token-for-u-username",
  "user": {
    "id": "u-username",
    "username": "username",
    "avatarColor": "bg-blue-500",
    "createdAt": "2026-01-28T09:14:25.950328+08:00",
    "updatedAt": "2026-01-28T09:14:25.950328+08:00"
  }
}
```

**é”™è¯¯å“åº”ï¼š**
| çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|--------|----------|
| 400 | ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦ï¼Œå¯†ç è‡³å°‘6ä¸ªå­—ç¬¦ |
| 409 | ç”¨æˆ·åå·²è¢«æ³¨å†Œ |
| 500 | æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯• |

---

### ç”¨æˆ·ç™»å½•

éªŒè¯å·²æ³¨å†Œç”¨æˆ·çš„å‡­æ®ã€‚

```http
POST /api/auth/login
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "string",
  "password": "string"
}
```

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
  "token": "mock-jwt-token-for-u-username",
  "user": {
    "id": "u-username",
    "username": "username",
    "avatarColor": "bg-blue-500",
    "createdAt": "2026-01-28T09:14:25.950328+08:00",
    "updatedAt": "2026-01-28T09:14:25.950328+08:00"
  }
}
```

**é”™è¯¯å“åº”ï¼š**
| çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|--------|----------|
| 400 | ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º |
| 401 | ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ |

---

## å®¶åº­æ¥å£ (Family)

### åˆ›å»ºå®¶åº­

ä¸ºå½“å‰ç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ–°å®¶åº­ã€‚ç”¨æˆ·å¿…é¡»æœªåŠ å…¥ä»»ä½•å®¶åº­ã€‚

```http
POST /api/family/create
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "name": "string (å®¶åº­åç§°)"
}
```

**æˆåŠŸå“åº” (201)ï¼š**
```json
{
  "message": "å®¶åº­åˆ›å»ºæˆåŠŸ",
  "familyId": "family-xxxxxxxx",
  "folder": {
    "id": "folder-family-xxxxxxxx",
    "name": "xxx çš„å…±äº«",
    "icon": "ğŸ ",
    "type": "family"
  }
}
```

**é”™è¯¯å“åº”ï¼š**
| çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|--------|----------|
| 400 | è¯·æä¾›å®¶åº­åç§° |
| 404 | ç”¨æˆ·ä¸å­˜åœ¨ |
| 409 | æ‚¨å·²å±äºä¸€ä¸ªå®¶åº­ï¼Œè¯·å…ˆé€€å‡ºå½“å‰å®¶åº­ |

---

### åŠ å…¥å®¶åº­

ä½¿ç”¨å®¶åº­ç¼–å·åŠ å…¥å·²å­˜åœ¨çš„å®¶åº­ã€‚

```http
POST /api/family/join
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "familyId": "family-xxxxxxxx"
}
```

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
  "message": "æˆåŠŸåŠ å…¥å®¶åº­",
  "familyId": "family-xxxxxxxx"
}
```

**é”™è¯¯å“åº”ï¼š**
| çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|--------|----------|
| 400 | è¯·æä¾›å®¶åº­ç¼–å· |
| 404 | å®¶åº­ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥å®¶åº­ç¼–å· |
| 409 | æ‚¨å·²å±äºä¸€ä¸ªå®¶åº­ï¼Œè¯·å…ˆé€€å‡ºå½“å‰å®¶åº­ |

---

### é€€å‡ºå®¶åº­

é€€å‡ºå½“å‰æ‰€å±çš„å®¶åº­ã€‚

```http
POST /api/family/leave
```

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
  "message": "å·²é€€å‡ºå®¶åº­"
}
```

**é”™è¯¯å“åº”ï¼š**
| çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|--------|----------|
| 400 | æ‚¨å½“å‰ä¸å±äºä»»ä½•å®¶åº­ |

---

### è·å–å®¶åº­æˆå‘˜

è·å–å½“å‰å®¶åº­çš„æ‰€æœ‰æˆå‘˜åˆ—è¡¨ã€‚

```http
GET /api/family/members
```

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
  "familyId": "family-xxxxxxxx",
  "members": [
    {
      "id": "u-user1",
      "username": "user1",
      "avatarColor": "bg-blue-500"
    },
    {
      "id": "u-user2",
      "username": "user2",
      "avatarColor": "bg-green-500"
    }
  ]
}
```

å¦‚æœç”¨æˆ·æœªåŠ å…¥ä»»ä½•å®¶åº­ï¼š
```json
{
  "familyId": null,
  "members": []
}
```

---

### è·å–å®¶åº­å…±äº«ç¬”è®°

è·å–å½“å‰å®¶åº­çš„æ‰€æœ‰å…±äº«ç¬”è®°ã€‚

```http
GET /api/family/notes
```

**æˆåŠŸå“åº” (200)ï¼š**
```json
[
  {
    "id": "note-id",
    "userId": "u1",
    "familyId": "family-xxxxxxxx",
    "title": "å®¶åº­å…±äº«ç¬”è®°",
    "content": "å†…å®¹...",
    "createdAt": "2026-01-28T00:00:00Z",
    "updatedAt": "2026-01-28T00:00:00Z"
  }
]
```

---

## ç¬”è®°æ¥å£ (Notes)

### è·å–ç¬”è®°åˆ—è¡¨

è·å–å½“å‰ç”¨æˆ·çš„æ‰€æœ‰ç¬”è®°ã€‚

```http
GET /api/notes
GET /api/notes?folderId=1
GET /api/notes?search=å…³é”®è¯
```

**æŸ¥è¯¢å‚æ•°ï¼š**
| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| folderId | string | å¯é€‰ï¼ŒæŒ‰æ–‡ä»¶å¤¹ç­›é€‰ |
| search | string | å¯é€‰ï¼Œæœç´¢æ ‡é¢˜å’Œå†…å®¹ |

**æˆåŠŸå“åº” (200)ï¼š**
```json
[
  {
    "id": "note-id",
    "userId": "u1",
    "folderId": "1",
    "title": "ç¬”è®°æ ‡é¢˜",
    "content": "ç¬”è®°å†…å®¹",
    "isPublic": false,
    "publicPermission": "read",
    "createdAt": "2026-01-28T00:00:00Z",
    "updatedAt": "2026-01-28T00:00:00Z"
  }
]
```

---

### åˆ›å»ºç¬”è®°

åˆ›å»ºæ–°ç¬”è®°ã€‚

```http
POST /api/notes
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "id": "string (å¯é€‰ï¼Œä¸æä¾›åˆ™è‡ªåŠ¨ç”Ÿæˆ)",
  "title": "string",
  "content": "string",
  "folderId": "string"
}
```

**æˆåŠŸå“åº” (201)ï¼š**
```json
{
  "id": "note-id",
  "userId": "u1",
  "folderId": "1",
  "title": "ç¬”è®°æ ‡é¢˜",
  "content": "ç¬”è®°å†…å®¹",
  "createdAt": "2026-01-28T00:00:00Z",
  "updatedAt": "2026-01-28T00:00:00Z"
}
```

---

### æ›´æ–°ç¬”è®°

æ›´æ–°å·²æœ‰ç¬”è®°çš„å†…å®¹ã€‚

```http
PUT /api/notes/:id
```

**è·¯å¾„å‚æ•°ï¼š**
| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| id | string | ç¬”è®° ID |

**è¯·æ±‚ä½“ï¼š**
```json
{
  "title": "string",
  "content": "string"
}
```

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
  "id": "note-id",
  "title": "æ›´æ–°åçš„æ ‡é¢˜",
  "content": "æ›´æ–°åçš„å†…å®¹",
  "updatedAt": "2026-01-28T00:00:00Z"
}
```

**é”™è¯¯å“åº”ï¼š**
| çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|--------|----------|
| 404 | Note not found |

---

### åˆ é™¤ç¬”è®°

åˆ é™¤æŒ‡å®šç¬”è®°ã€‚

```http
DELETE /api/notes/:id
```

**è·¯å¾„å‚æ•°ï¼š**
| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| id | string | ç¬”è®° ID |

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
  "message": "Note deleted"
}
```

---

## äº‹ä»¶æ¥å£ (Events)

### è·å–äº‹ä»¶åˆ—è¡¨

è·å–å½“å‰ç”¨æˆ·çš„æ—¥å†äº‹ä»¶ã€‚

```http
GET /api/events
GET /api/events?start=2026-01-01&end=2026-12-31
```

**æŸ¥è¯¢å‚æ•°ï¼š**
| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| start | string | å¯é€‰ï¼Œå¼€å§‹æ—¥æœŸ (YYYY-MM-DD) |
| end | string | å¯é€‰ï¼Œç»“æŸæ—¥æœŸ (YYYY-MM-DD) |

**æˆåŠŸå“åº” (200)ï¼š**
```json
[
  {
    "id": 1,
    "userId": "u1",
    "title": "äº‹ä»¶æ ‡é¢˜",
    "description": "äº‹ä»¶æè¿°",
    "date": "2026-01-28T00:00:00Z",
    "type": "solar",
    "recurrence": "none",
    "notifyUsers": "[\"u1\",\"u2\"]",
    "showCountdown": true,
    "isSystem": false,
    "createdAt": "2026-01-28T00:00:00Z",
    "updatedAt": "2026-01-28T00:00:00Z"
  }
]
```

---

### åˆ›å»ºäº‹ä»¶

åˆ›å»ºæ–°çš„æ—¥å†äº‹ä»¶ã€‚

```http
POST /api/events
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "title": "string",
  "description": "string (å¯é€‰)",
  "date": "2026-01-28T00:00:00Z",
  "type": "solar | lunar | holiday | term",
  "recurrence": "none | daily | weekly | monthly | yearly",
  "notifyUsers": "[\"u1\",\"u2\"]",
  "showCountdown": true
}
```

**æˆåŠŸå“åº” (201)ï¼š**
```json
{
  "id": 1,
  "userId": "u1",
  "title": "äº‹ä»¶æ ‡é¢˜",
  "date": "2026-01-28T00:00:00Z",
  "type": "solar",
  "recurrence": "none",
  "createdAt": "2026-01-28T00:00:00Z"
}
```

---

### åˆ é™¤äº‹ä»¶

åˆ é™¤æŒ‡å®šäº‹ä»¶ã€‚

```http
DELETE /api/events/:id
```

**è·¯å¾„å‚æ•°ï¼š**
| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| id | string | äº‹ä»¶ ID |

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
  "message": "Event deleted"
}
```

---

## é€šç”¨é”™è¯¯å“åº”

æ‰€æœ‰æ¥å£åœ¨å‘ç”Ÿé”™è¯¯æ—¶è¿”å›ä»¥ä¸‹æ ¼å¼ï¼š

```json
{
  "error": "é”™è¯¯ä¿¡æ¯"
}
```

---

## CORS é…ç½®

åç«¯å·²é…ç½® CORS ä¸­é—´ä»¶ï¼Œå…è®¸ï¼š
- **Origin**: `*` (æ‰€æœ‰æ¥æº)
- **Methods**: `POST, GET, OPTIONS, PUT, DELETE`
- **Headers**: `Content-Type, Authorization`
